identity:
  name: "openai_trigger"
  author: "bowenliang123"
  label:
    en_US: OpenAI Webhook Trigger
    zh_Hans: OpenAI Webhook 触发器
  description:
    en_US: "OpenAI Webhook Trigger for Dify, receiving real-time notifications about events in the API of batch, response, evaluation, fine-tuning and etc."
    zh_Hans: "Dify 的 OpenAI Webhook 触发器，实时接收有关批处理、响应、评估、微调等 API 事件的通知。"
  icon: "icon.svg"

subscription_schema:
  - name: "webhook_secret"
    type: "secret-input"
    required: true
    label:
      en_US: "Webhook Signing Secret"
      zh_Hans: "Webhook 签名密钥"
    help:
      en_US: "The signing secret issued  by OpenAI when webhooks configured for verifying incoming webhook signature"
      zh_Hans: "配置Webhook时OpenAI分配的签名密钥，用于验证传入的 Webhook 签名"

subscription_constructor:
  parameters:
  - name: "events"
    type: "checkbox"
    multiple: true
    required: true
    default: ["openai_trigger_event"]
    options:
      - value: "openai_trigger_event"
        label:
          en_US: "OpenaiTrigger Event"
          zh_Hans: "openai_trigger 事件"
          pt_BR: "Evento OpenaiTrigger"
          ja_JP: "openai_trigger イベント"
    label:
      en_US: "Events to Subscribe"
      zh_Hans: "订阅的事件"
      pt_BR: "Eventos para inscrever"
      ja_JP: "購読するイベント"
    help:
      en_US: "Select which trigger events should be delivered to this subscription."
      zh_Hans: "选择哪些触发事件应该推送到这个订阅。"
      pt_BR: "Selecione quais eventos de gatilho devem ser entregues para esta inscrição."
      ja_JP: "このサブスクリプションに配信するトリガーイベントを選択します。"

events:
  # response
  - events/response/completed/event.yaml
  - events/response/cancelled/event.yaml
  - events/response/failed/event.yaml
  - events/response/incomplete/event.yaml
  # batch
  - events/batch/completed/event.yaml
  - events/batch/cancelled/event.yaml
  - events/batch/expired/event.yaml
  - events/batch/failed/event.yaml
  # fine_tuning
  - events/fine_tuning/job/succeeded/event.yaml
  - events/fine_tuning/job/failed/event.yaml
  - events/fine_tuning/job/cancelled/event.yaml
  # eval
  - events/eval/run/succeeded/event.yaml
  - events/eval/run/failed/event.yaml
  - events/eval/run/canceled/event.yaml
  # incoming
  - events/realtime/call/incoming/event.yaml

extra:
  python:
    source: provider/openai_trigger.py
